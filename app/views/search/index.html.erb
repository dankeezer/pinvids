<div class="mt-6">
  <%= form_tag search_path, method: "get" do %>
    <%= search_field_tag :query, nil, autocomplete: "off", placeholder: "Search Machines, Tournaments ...", class: "form-control w-full", onkeyup: "onKeyUp(this.value)" %>
  <% end %>
</div>
<div id="autocomplete-results" class="absolute bg-white w-full"></div>

<script>
  // Super jank / prototype / proof-of-concept only, recommend using React component
  const machines = <%= raw @machines.to_json %>;
  const buildLine = (name) => `<a href="?query=${name}"><div class="m-1">${name}</div></a>`;
  const onKeyUp = (value) => {
    const filteredMachines = machines.filter(m => m.toLowerCase().includes(value.toLowerCase()));
    document.getElementById('autocomplete-results').innerHTML = filteredMachines.map(buildLine).join('');
  };
</script>

<div class="mt-6">
  <% if @search_results.present? %>
    <h2>All Results</h2>
    <ul class="mt-2">
      <% @search_results.each do |result| %>
        <li><%= link_to result.name, result %></li>
      <% end %>
    </ul>
  <% end %>
</div>